# The Last of Guss

Браузерная игра, где игроки соревнуются, кто быстрее и больше натапает по виртуальному гусю, подхватившему мутацию G-42.

## Демо

- React: [https://the-last-of-guss-frontend.onrender.com/](https://the-last-of-guss-frontend.onrender.com/)
- Vue: [https://the-last-of-guss-frontend-vue.onrender.com/](https://the-last-of-guss-frontend-vue.onrender.com/)

Бэкенд демо-версии размещён на бесплатном хостинге, поэтому после долгого простоя первый запрос может выполняться с задержкой.

#### Пользователи игры:

- admin:admin - может создавать раунд
- nikita:nikita - пользователь, тапы которого не засчитываются
- Любой другой пользователь (кроме вариаций nikita типа Никита, Nikita, NiKiTA и т. д.) - может тапать

## Локальный запуск

### 1. Установка зависимостей

```bash
pnpm install
```

### 2. Настройка переменных окружения

В каждой из папок `backend` и `frontend` есть файл `env.example` с примерами переменных окружения.

- Скопируйте файл `env.example` в `.env` и при необходимости отредактируйте значения:

```bash
cp backend/env.example backend/.env
cp frontend/env.example frontend/.env
```

### 3. Миграция базы данных

```bash
pnpm mg
```

### 4. Запуск

```bash
npm run dev
```

Окно с игрой должно открыться в браузере автоматически

## Задача

Разработка браузерной игры "The Last of Guss", где игроки соревнуются, кто быстрее и больше натапает по виртуальному гусю, подхватившему мутацию G-42.

У раунда есть дата старта и дата завершения. Длительность раунда и cooldown должны быть конфигурируемы, достаточно чтобы они применялись при старте бекенда. Cooldown - время между датой создания раунда и датой начала. Нужно для того, чтобы игроки успели зайти на страницу раунда.
Например,

```bash
# .env
ROUND_DURATION=60 # минута на раунд
COOLDOWN_DURATION=30 # полминуты обратного отсчета
```

Правила раунда:

- 1 тап = 1 очко, каждый одиннадцатый тап дает 10 очков
- тапать можно только в рамках активного рануда
- активный раунд тот, который уже начался, но еще не закончился

Пользователи игры:

- выживший – может тапать
- если выжившего зовут Никита, то его тапы не считаются(в статистике показывать нули), хотя и запрос на тап работает как у обычного выжившего
- admin, может создавать раунд

Роли можно назначать во время создания пользователя исходя из его имени. Например, если username - admin, то роль admin, если username Никита, то роль nikita.

### Бекенд

Бекенд на postgres, nodejs и typescript(с включенным strict). ORM на выбор: sequelize, drizzle, prisma, typeorm. API framework на выбор Fastify, Nest.

**Когда происходит тап по гусю нужно обеспечить консистентность данных, корректность расчета очков(учесть возможные race conditions) и состояния раунда**.
Например:

- проверяется роль пользователя(Никита или нет)
- проверяется, что раунд активен(текущее время в диапазоне от даты старта до даты завершения раунда)
- увеличивается счетчик тапов и очков игрока в данном раунде
- увеличивается общий счетчик очков в раунде

REST API - приемлемый вариант.

Обязательно нужно **учесть** возможность запускать несколько серверов с бекендом(например, 1 база и 3 nodejs app).
Предполагаемый способ развёртывания: 1 база, 1 реверс прокси, 3 бекенда в докер контейнерах. Реализовывать это не нужно, только учесть в разработке, что нет привязки пользователя к определенному инстансу бекенда. compose и Dockerfile можно не писать. Для запуска достаточно реализовать просто `node dist/index.js`

Ожидаемая нагрузка: это тестовое задание и можно рассчитывать на кол-во выживших в раунде около 10, однако, желательно использовать масштабируемые решения.

Возможный, но не обязательный вариант роутов для REST API.

- логин(с помощью куки либо токена либо токена в куке)
- получение списка раундов, можно без пагинации
- создание раунда
- получение информации по раунду, включает инфу о победителе(если раунд завершен) и о своих очках
- тап по гусю, возвращает информацию о кол-ве собственных очков

### Фронтенд

Фронтенд на react, typescript, react-router, vite. UI библиотека и стейт менеджер на выбор.

3 страницы:

- логин, где вводится имя и пароль, если такого в базе нет, то он создается, если есть и пароль не совпадает, то показывает ошибку под кнопкой
- список текущих активных и запланированных раундов, айди раунда - ссылка на раунд, кнопка создания раунда, если пользователь админ, по нажатию сразу переводит на страницу раунда
- страница раунда с его состоянием(завершен, активен, еще не начат) с гусем, по которому можно тапать если раунд активен

---

Ожидаем чистый код с соблюдением SOLID, корректность API, отзывчивый фронтенд.

---

### Мокапы:

```
┌───────────────────────────────────────┐
│               ВОЙТИ                   │
├───────────────────────────────────────┤
│                                       │
│  Имя пользователя:                    │
│  ┌─────────────────────────────────┐  │
│  │                                 │  │
│  └─────────────────────────────────┘  │
│  Пароль:                              │
│  ┌─────────────────────────────────┐  │
│  │                                 │  │
│  └─────────────────────────────────┘  │
│                                       │
│  ┌─────────────────────────────────┐  │
│  │          Войти                  │  │
│  └─────────────────────────────────┘  │
│                                       │
└───────────────────────────────────────┘
```

```
┌─────────────────────────────────────────────────────────────────────┐
│                        Список РАУНДОВ                   Имя игрока  │
├─────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐                                                │
│  │ Создать раунд   │                                                │  <–– видна, если админ
│  └─────────────────┘                                                │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │  ● Round ID: 8c3eed83-8a8a-41a0-8f91-9ad501e8f8a1             │  │  <–– ссылка на раунд
│  │                                                               │  │
│  │  Start: 18.05.2025, 06:28:17                                  │  │
│  │  End:   18.05.2025, 06:29:17                                  │  │
│  │                                                               │  │
│  │  ──────────────────────────────────────────────────────────── │  │
│  │  Статус: Активен                                              │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                     │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │  ● Round ID: 8c3eed83-8a8a-41a0-8f91-9ad501e8f8a2             │  │
│  │                                                               │  │
│  │  Start: 18.05.2025, 07:28:17                                  │  │
│  │  End:   18.05.2025, 08:29:17                                  │  │
│  │                                                               │  │
│  │  ──────────────────────────────────────────────────────────── │  │
│  │  Статус: Cooldown                                             │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

```
┌───────────────────────────────────────┐
│               Раунды       Имя игрока │
├───────────────────────────────────────┤
│                                       │
│            ░░░░░░░░░░░░░░░            │
│          ░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░           │
│        ░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░         │
│        ░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░         │
│      ░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░       │
│    ░░▒▒▒▒░░░░▓▓▓▓▓▓▓▓▓▓▓▓░░░░▒▒▒▒░░   │
│    ░░▒▒▒▒▒▒▒▒░░░░░░░░░░░░▒▒▒▒▒▒▒▒░░   │
│    ░░▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒░░   │
│      ░░▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒░░     │
│        ░░░░░░░░░░░░░░░░░░░░░░░░░░     │
│                                       │
│            Раунд активен!             │  <–– состояние рануда меняется, когда приходит время
│        До конца осталось: 00:23       │  <–– счетчик времени, обновляется раз в секунду
│            Мои очки - 123             │  <–– обновляется с каждым собственным тапом
│                                       │
└───────────────────────────────────────┘
```

```
┌───────────────────────────────────────┐
│               Cooldown     Имя игрока │
├───────────────────────────────────────┤
│                                       │
│            ░░░░░░░░░░░░░░░            │
│          ░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░           │
│        ░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░         │
│        ░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░         │
│      ░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░       │
│    ░░▒▒▒▒░░░░▓▓▓▓▓▓▓▓▓▓▓▓░░░░▒▒▒▒░░   │
│    ░░▒▒▒▒▒▒▒▒░░░░░░░░░░░░▒▒▒▒▒▒▒▒░░   │
│    ░░▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒░░   │
│      ░░▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒░░     │
│        ░░░░░░░░░░░░░░░░░░░░░░░░░░     │
│                                       │
│              Cooldown                 │  <–– состояние раунда меняется, когда приходит время
│        до начала раунда 00:15         │  <–– счетчик времени, обновляется раз в секунду
│                                       │
└───────────────────────────────────────┘

```

```
┌───────────────────────────────────────┐
│           Раунд завершен   Имя игрока │
├───────────────────────────────────────┤
│                                       │
│            ░░░░░░░░░░░░░░░            │
│          ░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░           │
│        ░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░         │
│        ░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░         │
│      ░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░       │
│    ░░▒▒▒▒░░░░▓▓▓▓▓▓▓▓▓▓▓▓░░░░▒▒▒▒░░   │
│    ░░▒▒▒▒▒▒▒▒░░░░░░░░░░░░▒▒▒▒▒▒▒▒░░   │
│    ░░▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒░░   │
│      ░░▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒░░     │
│        ░░░░░░░░░░░░░░░░░░░░░░░░░░     │
│                                       │
│  ---------------------------------    │
│  Всего               999999           │ <–– статистика раунда
│  Победитель - Иван   100500           │
│  Мои очки            321              │
│                                       │
└───────────────────────────────────────┘
```

## ⚠️ Уведомление о лицензии:

Этот проект был создан в рамках выполнения тестового задания. Исходный код **не лицензирован** для повторного использования или распространения. Все права защищены и принадлежат автору.
